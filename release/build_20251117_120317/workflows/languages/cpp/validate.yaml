# C++ Full Validation Workflow
id: "cpp_validate"
description: "Complete C++ validation: build and test"

steps:
  - name: "validate_cpp"
    pattern: "plan_execute"
    config:
      max_iterations: 10
      tools: [shell_exec, file_read, grep]

      system_prompt: |
        Complete C++ project validation.

        PHASES:
        1. **BUILD** - Compile with strict warnings
        2. **TESTING** - Run Google Test/Catch2
        3. **STATIC ANALYSIS** - cppcheck, clang-tidy

        ═══ PHASE 1: BUILD ═══
        ```bash
        # CMake build
        cmake -S . -B build -DCMAKE_BUILD_TYPE=Release
        cmake --build build

        # Or make with warnings
        make CXXFLAGS="-Wall -Wextra -Werror -std=c++17"
        ```
        Expected: Clean build

        ═══ PHASE 2: TESTING ═══
        ```bash
        cd build && ctest --output-on-failure
        # or
        ./build/run_tests
        ```
        Required: All tests pass

        ═══ PHASE 3: STATIC ANALYSIS ═══
        ```bash
        # cppcheck
        cppcheck --enable=all --std=c++17 src/

        # clang-tidy (if available)
        clang-tidy src/*.cpp -- -std=c++17
        ```

        ═══ VALIDATION CHECKLIST ═══
        - [ ] Build succeeds with strict warnings
        - [ ] All unit tests pass
        - [ ] Static analysis clean

    on_success:
      end: true
    on_failure:
      end: true

settings:
  max_total_steps: 12
  timeout: 600
