# Few-Shot Examples for Planning LLM
# These examples teach the Planning LLM how to create good task plans

examples:
  # Example 1: Simple File Read
  - category: "basic"
    user_query: "Show me the main.rs file"
    plan:
      plan_id: "read-main-001"
      query: "Show me the main.rs file"
      goal: "Read and display main.rs contents"
      tasks:
        - id: 1
          action: "read_file"
          target: "src/main.rs"
          reason: "User wants to view the main source file"
          expected_outcome: "File contents displayed for user review"
          depends_on: []
          params: {}

  # Example 2: Debug Test Failure
  - category: "debugging"
    user_query: "The test_login function is failing, can you fix it?"
    plan:
      plan_id: "debug-test-login-001"
      query: "The test_login function is failing, can you fix it?"
      goal: "Identify and fix the bug causing test_login to fail"
      tasks:
        - id: 1
          action: "read_file"
          target: "tests/auth_test.rs"
          reason: "Understand what the test is checking and its assertions"
          expected_outcome: "See test setup and expected behavior"
          depends_on: []

        - id: 2
          action: "run_test"
          target: "test_login"
          reason: "Get the actual error message and failure details"
          expected_outcome: "Error message identifying the problem"
          depends_on: [1]

        - id: 3
          action: "analyze_error"
          reason: "Parse the error to identify root cause"
          expected_outcome: "Understanding of what's failing and why"
          depends_on: [2]

        - id: 4
          action: "read_file"
          target: "src/auth/login.rs"
          reason: "Examine the login implementation being tested"
          expected_outcome: "Locate the buggy code"
          depends_on: [3]

        - id: 5
          action: "edit_file"
          target: "src/auth/login.rs"
          reason: "Fix the identified bug in the login function"
          expected_outcome: "Bug fixed, code should work correctly"
          depends_on: [4]

        - id: 6
          action: "run_test"
          target: "test_login"
          reason: "Verify that the fix resolves the test failure"
          expected_outcome: "Test passes successfully"
          depends_on: [5]

  # Example 3: Git Commit
  - category: "git"
    user_query: "Commit my changes with message 'feat: add authentication'"
    plan:
      plan_id: "commit-auth-feat-001"
      query: "Commit my changes with message 'feat: add authentication'"
      goal: "Safely commit authentication changes to git"
      tasks:
        - id: 1
          action: "git_status"
          reason: "Check which files have been modified"
          expected_outcome: "List of changed files to review"
          depends_on: []

        - id: 2
          action: "git_diff"
          reason: "Review the actual changes before committing"
          expected_outcome: "Diff showing all modifications"
          depends_on: [1]

        - id: 3
          action: "run_test"
          reason: "Ensure all tests pass before committing"
          expected_outcome: "All tests pass"
          depends_on: [1]

        - id: 4
          action: "git_add"
          reason: "Stage all changes for commit"
          expected_outcome: "Changes staged"
          depends_on: [2, 3]
          params:
            paths: ["."]

        - id: 5
          action: "git_commit"
          reason: "Commit the staged changes with provided message"
          expected_outcome: "Changes committed to repository"
          depends_on: [4]
          params:
            message: "feat: add authentication"
            signoff: true

  # Example 4: Build Error Fix
  - category: "debugging"
    user_query: "Fix the compilation errors"
    plan:
      plan_id: "fix-build-errors-001"
      query: "Fix the compilation errors"
      goal: "Resolve all compilation errors to get code building"
      tasks:
        - id: 1
          action: "run_build"
          reason: "Get the current compilation error messages"
          expected_outcome: "List of compilation errors"
          depends_on: []

        - id: 2
          action: "analyze_error"
          reason: "Parse compiler errors and identify types"
          expected_outcome: "Understanding of error categories and priority"
          depends_on: [1]

        - id: 3
          action: "read_file"
          target: "{error_file}"
          reason: "Examine the file with the first error"
          expected_outcome: "See code context around error"
          depends_on: [2]

        - id: 4
          action: "edit_file"
          target: "{error_file}"
          reason: "Fix the compilation error"
          expected_outcome: "Error resolved"
          depends_on: [3]

        - id: 5
          action: "run_build"
          reason: "Verify error is fixed and check for remaining errors"
          expected_outcome: "Either build succeeds or shows remaining errors"
          depends_on: [4]

  # Example 5: Code Search
  - category: "search"
    user_query: "Find all implementations of the ChatModel trait"
    plan:
      plan_id: "search-chatmodel-001"
      query: "Find all implementations of the ChatModel trait"
      goal: "Locate all ChatModel trait implementations in the codebase"
      tasks:
        - id: 1
          action: "grep"
          reason: "Search for 'impl ChatModel' across Rust files"
          expected_outcome: "List of files implementing ChatModel"
          depends_on: []
          params:
            pattern: "impl.*ChatModel"
            glob: "src/**/*.rs"

        - id: 2
          action: "read_file"
          target: "{first_match}"
          reason: "Examine one implementation as example"
          expected_outcome: "Understand how ChatModel is implemented"
          depends_on: [1]

# Guidelines for Good Plans
planning_guidelines:
  task_count:
    - "Simple queries: 1-3 tasks"
    - "Debugging: 5-8 tasks"
    - "Feature implementation: 8-15 tasks"
    - "Optimal range: 5-7 tasks"

  dependencies:
    - "Task 1 has no dependencies"
    - "Each task depends only on earlier tasks"
    - "Common pattern: read → analyze → modify → verify"
    - "Verification tasks depend on modification tasks"

  reasoning:
    - "Explain WHY each task is needed"
    - "Describe expected outcome"
    - "Think step-by-step"
    - "Consider what information each step provides for next steps"

  verification:
    - "Include run_test after code changes"
    - "Include run_build after modifications"
    - "Verify changes don't break existing functionality"

# Common Patterns
common_patterns:
  read_modify_write:
    - "read_file (understand current state)"
    - "edit_file (make changes)"
    - "run_test (verify changes)"

  debug_test:
    - "read_file (test file)"
    - "run_test (get error)"
    - "analyze_error (understand failure)"
    - "read_file (implementation)"
    - "edit_file (fix bug)"
    - "run_test (verify fix)"

  git_workflow:
    - "git_status (check state)"
    - "git_diff (review changes)"
    - "git_add (stage changes)"
    - "git_commit (save changes)"

  search_and_edit:
    - "grep (find pattern)"
    - "read_file (examine matches)"
    - "edit_file (make changes)"
    - "run_test (verify)"
