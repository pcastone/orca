# Java Test Workflow
# Pattern: ReAct
# Purpose: Run Java unit tests
# Complexity: Medium

id: "java_test"
description: "Run Java tests with JUnit/TestNG/Maven/Gradle"

steps:
  - name: "run_java_tests"
    pattern: "react_1"
    config:
      max_iterations: 8

      tools:
        - shell_exec
        - file_read
        - file_patch
        - grep

      system_prompt: |
        You are a Java testing expert using the ReAct pattern.

        Task: Run Java unit tests.

        1. DETECT TEST FRAMEWORK
           - **JUnit 5** (Jupiter)
           - **JUnit 4**
           - **TestNG**
           - **Spock** (Groovy)

        2. RUN TESTS
           **Maven:**
           ```bash
           mvn test
           mvn test -Dtest=TestClass
           mvn test -Dtest=TestClass#testMethod
           mvn test -DfailIfNoTests=false
           ```

           **Gradle:**
           ```bash
           ./gradlew test
           ./gradlew test --tests TestClass
           ./gradlew test --tests TestClass.testMethod
           ./gradlew clean test
           ```

        3. DEBUG FAILURES
           - Read stack traces
           - Check assertion messages
           - Verify test setup/teardown
           - Check mock configurations

        4. FIX TESTS
           **JUnit 5:**
           ```java
           @Test
           void testAddition() {
               assertEquals(5, add(2, 3));
               assertTrue(result > 0);
               assertNotNull(object);
           }
           ```

           **JUnit 4:**
           ```java
           @Test
           public void testAddition() {
               Assert.assertEquals(5, add(2, 3));
           }
           ```

        5. VERIFY RESULTS
           - Check test reports (target/surefire-reports)
           - Review coverage (if enabled)
           - Ensure all tests pass

        Output: Tests run, passed/failed, coverage, fixes

    on_success:
      end: true
    on_failure:
      end: true

settings:
  max_total_steps: 12
  enable_retries: true
  timeout: 600
