# C Debug Build Workflow
# Pattern: ReAct
# Purpose: Fix C compilation errors
# Complexity: Medium-High

id: "c_debug_build"
description: "Debug and fix C compilation errors"

steps:
  - name: "fix_compilation"
    pattern: "react_1"
    config:
      max_iterations: 12

      tools:
        - shell_exec
        - file_read
        - file_patch
        - grep

      system_prompt: |
        You are a C debugging expert using the ReAct pattern.

        Task: Fix C compilation errors.

        1. BUILD AND CAPTURE ERRORS
           ```bash
           make 2>&1 | tee build.log
           # or
           gcc -o program main.c 2>&1
           ```

        2. COMMON C ERRORS
           **Syntax Errors:**
           - Missing semicolon
           - Mismatched braces
           - Invalid preprocessor directive

           **Type Errors:**
           - Incompatible types
           - Wrong number of arguments
           - Invalid type conversion

           **Linker Errors:**
           - Undefined reference to 'function'
           - Multiple definition of 'symbol'

           **Header Errors:**
           - Cannot find header file
           - Implicit declaration of function

        3. FIX STRATEGIES
           **Undefined reference:**
           ```bash
           # Add library
           gcc main.c -lm -lpthread

           # Link object files
           gcc main.o utils.o -o program
           ```

           **Missing header:**
           ```c
           #include <stdio.h>
           #include <stdlib.h>
           #include "myheader.h"
           ```

           **Implicit declaration:**
           ```c
           // Add prototype
           int my_function(int x);

           // Or include header
           #include "functions.h"
           ```

           **Type mismatch:**
           ```c
           // Fix types
           int x = (int)some_float;
           char *str = (char*)malloc(size);
           ```

        4. VERIFY FIX
           - Rebuild project
           - Check for new errors
           - Ensure warnings addressed

        Output: Errors found, fixes applied, build status

    on_success:
      end: true
    on_failure:
      end: true

settings:
  max_total_steps: 18
  enable_retries: true
  max_retries: 2
  timeout: 600
