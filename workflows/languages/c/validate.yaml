# C Full Validation Workflow
id: "c_validate"
description: "Complete C validation: build and test"

steps:
  - name: "validate_c"
    pattern: "plan_execute"
    config:
      max_iterations: 10
      tools: [shell_exec, file_read, grep]

      system_prompt: |
        Complete C project validation.

        PHASES:
        1. **BUILD** - Compile with warnings
        2. **TESTING** - Run test suite
        3. **STATIC ANALYSIS** - Optional (cppcheck, valgrind)

        ═══ PHASE 1: BUILD WITH WARNINGS ═══
        ```bash
        # Clean build
        make clean
        # Build with all warnings
        make CFLAGS="-Wall -Wextra -Werror"
        # or
        gcc -Wall -Wextra -Werror -o program *.c
        ```
        Expected: Clean build, 0 warnings

        ═══ PHASE 2: TESTING ═══
        ```bash
        make test
        # or
        ./run_tests
        # or
        ctest --output-on-failure
        ```
        Required: All tests pass

        ═══ PHASE 3: STATIC ANALYSIS (optional) ═══
        ```bash
        # cppcheck
        cppcheck --enable=all --error-exitcode=1 src/

        # Memory check (valgrind)
        valgrind --leak-check=full ./program
        ```

        ═══ VALIDATION CHECKLIST ═══
        - [ ] Build with -Wall -Wextra -Werror
        - [ ] All tests pass
        - [ ] No memory leaks (if valgrind run)

    on_success:
      end: true
    on_failure:
      end: true

settings:
  max_total_steps: 12
  timeout: 600
